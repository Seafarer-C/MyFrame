# 1 目标

帮助大型前端应用实现「前端微服务」，提供分布式的前端解决方案。

# 2 思考

## 2-1 为什么选用 iframe

### 优劣势分析

<b>优势</b>

- 1 安全性强
- 2 天然沙盒
- 3 原生支持、兼容性强
- 4 低心智负担

<b>劣势</b>

- 1 渲染效率低
- 2 SEO 支持差
- 3 内存不友好

<b>权衡优劣</b>

在「前端微服务」的场景下，安全性、沙盒特性以及兼容性是我们最需要关注的点，而这一切 iframe 都天然支持，并不需要开发者过度的进行设计与封装。且 iframe 设计中的 parent 与 child 关系，与调用方和被调用方的关系不谋而合，这能够很大程度降低开发者的心智负担。

另一方面，渲染效率低、SEO 支持差以及内存不友好是能够接受或者能够被解决的。我们具体分析一下这三个问题。

- <b>iframe 的渲染效率并不比其他微前端方案低，且是可提升的</b>
  iframe 之所以被诟病渲染效率低，主要原因在于渲染 iframe 与渲染 DOM 在加载资源的复杂度上存在差异。
  渲染 iframe 需要加载 html、js、css 以及其他相关静态资源，而 DOM 渲染则是执行解析过的 HTML 或异步执行已加载的 js，因此二者的效率差异本来就并非一个纬度。

  提升 iframe 渲染效率是完全可行的，因为 iframe 渲染提效与网站提效是同样的问题，SSR 方案、各种首屏优化方案都可以提升 iframe 的渲染效率。

  因此在衡量 iframe 渲染效率问题时，不应该粗暴的将其与 DOM 渲染效率进行对比，而应当考虑 iframe 的渲染性能是否被网站所接受。

- <b>SEO 并不应该作为「前端微服务」的考虑范畴</b>
  SEO 优化主要的目的在于提升搜索引擎对于网站的识别，而「前端微服务」中的微应用或者微模块本就是独立的站点，本身就可以具备 SEO 能力，因此这并不会成为技术选型时的压力。

- <b>内存问题更多取决于架构设计，并不是 iframe 的原罪</b>
  很多开发者谈及 iframe 时，都主观的认为 iframe 内存不友好，存在泄漏的风险，但是这种认知过于武断。

### 破局点

<b>importmap 的出现与逐渐流行</b>

importmap 支持同域名下资源的共享，主应用与子应用可以共享并缓存 js 与 css 资源，这能有效的提升渲染性能。

## 2-2 如何理解「前端微服务」

[相关 rfc: 如何实现前端微服务](./002-how-frontend-microservices.md)

## 2-3 如何理解「路由」

什么是路由，简单说，路由就是 URL 到函数的映射。

当今 SPA 大为流行，「前端路由」这个概念被反复提及，但是 MyFrame 主张消除对这种概念的使用与提倡，无论是前端路由还是后端路由，都应该回到他们的本质，即 URL 到函数的映射。
也就是说，我们推崇 react 哲学：页面即函数。

有了这个共识，「前端微服务」的理念才能真正与「微服务」的理念对齐。父应用通过「路由」驱动子应用，这与浏览器本身的路由无关。

## 2-4 微应用是「组件化」的分布式实践

组件化经由很长的一个周期的验证，已经成为前端领域非常成熟的方案。

# 3 提议内容

# 4 具体实施

# 5 其他
